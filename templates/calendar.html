{% extends "base.html" %}

{% block title %}Activity Calendar{% endblock %}

{% block extra_css %}
<style>
    .calendar {
        display: grid;
        grid-template-columns: repeat(7, 1fr);
        gap: 5px;
    }
    .calendar-day {
        aspect-ratio: 1;
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 0.8em;
        border-radius: 4px;
    }
</style>
{% endblock %}

{% block content %}
<h2 class="mb-4">Activity Calendar</h2>

{% if not current_user.strava_access_token %}
<div class="alert alert-info" role="alert">
    Connect your Strava account to see your activity data.
    <a href="{{ url_for('strava_auth') }}" class="btn btn-primary btn-sm ms-2">Connect Strava</a>
</div>
{% else %}
<div class="mb-3">
    <a href="{{ url_for('refresh_activities') }}" class="btn btn-primary">Refresh Strava Data</a>
</div>
{% endif %}

<div id="calendar" class="calendar mb-4"></div>

<div class="mt-4">
    <h5>Activity Level</h5>
    <div class="d-flex align-items-center">
        <div style="width: 20px; height: 20px; background-color: #e6ffe6;" class="me-2"></div>
        <span>Low</span>
    </div>
    <div class="d-flex align-items-center">
        <div style="width: 20px; height: 20px; background-color: #66ff66;" class="me-2"></div>
        <span>Medium</span>
    </div>
    <div class="d-flex align-items-center">
        <div style="width: 20px; height: 20px; background-color: #00cc00;" class="me-2"></div>
        <span>High</span>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/calendar.js') }}"></script>
<script>
    const activityData = {{ activity_data|safe }};
    renderCalendar(activityData);
</script>
{% endblock %}
