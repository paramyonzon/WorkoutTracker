{% extends "base.html" %}

{% block title %}Activity Calendar{% endblock %}

{% block extra_css %}
<style>
    .calendar-container {
        display: flex;
        flex-direction: column;
        margin-top: 20px;
    }
    .month-labels {
        display: flex;
        justify-content: space-around;
        margin-bottom: 10px;
    }
    .calendar-grid {
        display: flex;
    }
    .weekday-labels {
        display: flex;
        flex-direction: column;
        justify-content: space-around;
        padding-right: 10px;
    }
    .calendar {
        display: grid;
        grid-template-columns: repeat(53, 1fr);
        gap: 2px;
    }
    .calendar-day {
        width: 10px;
        height: 10px;
        border-radius: 2px;
    }
</style>
{% endblock %}

{% block content %}
<h2 class="mb-4">Activity Calendar</h2>

{% if not activity_data %}
<div class="alert alert-info" role="alert">
    Connect your Strava account to see your activity data.
    <a href="{{ url_for('strava_auth') }}" class="btn btn-primary btn-sm ms-2">Connect Strava</a>
</div>
{% else %}
<div class="mb-3">
    <a href="{{ url_for('refresh_activities') }}" class="btn btn-primary">Refresh Strava Data</a>
</div>
{% endif %}

<div class="calendar-container">
    <div class="month-labels" id="month-labels"></div>
    <div class="calendar-grid">
        <div class="weekday-labels">
            <span>Mon</span>
            <span>Wed</span>
            <span>Fri</span>
        </div>
        <div id="calendar" class="calendar"></div>
    </div>
</div>

<div class="mt-4">
    <h5>Activity Level</h5>
    <div class="d-flex align-items-center">
        <div class="calendar-day me-2" style="background-color: var(--bs-success-bg-subtle);"></div>
        <span>Less</span>
    </div>
    <div class="d-flex align-items-center">
        <div class="calendar-day me-2" style="background-color: var(--bs-success);"></div>
        <span>More</span>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/calendar.js') }}"></script>
<script>
    const activityData = {{ activity_data|safe }};
    renderCalendar(activityData);
</script>
{% endblock %}
